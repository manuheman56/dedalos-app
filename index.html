<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>DÉDALO'S – Guía del Héroe</title>
  <link rel="manifest" href="manifest.json">
  <style>
    :root { --gold: #c5a059; --blood: #7a0000; --parchment: #f4e4bc; --stone: #1a1a1a; }
    body { margin: 0; font-family: 'Verdana', serif; background: #050505; color: var(--parchment); text-align: center; }
    .screen { display: none; padding: 20px; animation: fadeIn 0.8s; flex-direction: column; align-items: center; }
    .active { display: flex; }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

    .scroll { background: var(--stone); border: 2px solid var(--gold); border-radius: 15px; padding: 20px; width: 95%; max-width: 550px; box-shadow: 0 0 30px #000; }
    h1 { color: var(--gold); font-size: 2.5em; letter-spacing: 4px; border-bottom: 2px solid var(--blood); margin: 10px 0; }
    h2 { color: var(--gold); margin-top: 0; }

    /* Contenedor de Imagen Explicativa */
    .img-card { background: #000; border: 1px solid var(--gold); border-radius: 10px; margin: 10px 0; padding: 5px; }
    .img-card img { width: 100%; border-radius: 8px; display: block; }
    .img-caption { font-size: 0.8em; color: var(--gold); padding: 5px; font-style: italic; }

    .kid-box { background: rgba(255,255,255,0.05); padding: 15px; border-radius: 10px; margin: 10px 0; text-align: left; border-left: 5px solid var(--gold); }
    .kid-box b { color: var(--gold); display: block; margin-bottom: 5px; }

    button { background: var(--blood); color: white; border: 1px solid var(--gold); padding: 18px; border-radius: 50px; font-weight: bold; font-size: 1.1em; cursor: pointer; width: 90%; margin: 10px; box-shadow: 0 4px 0 #000; }
    
    .dots { display: flex; justify-content: center; gap: 15px; margin: 20px 0; }
    .dot { width: 45px; height: 45px; border: 3px solid var(--gold); border-radius: 50%; line-height: 45px; font-size: 1.2em; }
    .dot.used { background: var(--gold); color: black; }

    /* Glosario rápido */
    .grid-help { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 10px; }
    .help-item { background: #333; padding: 10px; border-radius: 8px; font-size: 0.8em; }
    .help-item img { width: 60px; height: 60px; object-fit: cover; border-radius: 5px; margin-bottom: 5px; }
  </style>
</head>
<body>

<audio id="snd-ambiente" loop src="ambiente.mp3"></audio>
<audio id="snd-rugido" src="rugido.mp3"></audio>

<div id="intro" class="screen active">
  <h1>DÉDALO</h1>
  <div class="scroll">
    <div class="img-card">
      <img src="entrada.jpg" alt="Entrada del Laberinto">
      <div class="img-caption">Aquí comienza vuestra aventura</div>
    </div>
    <div class="kid-box">
      <b>¿Qué hay que hacer?</b>
      Todos empezáis en la ficha de <b>Entrada</b>. Debéis construir un camino para llegar a las esquinas.
    </div>
    <button onclick="iniciarMito()">Escuchar al Espíritu</button>
  </div>
</div>

<div id="rules" class="screen">
  <h2>¿Cómo moverte?</h2>
  <div class="scroll">
    <div class="kid-box">
      <b>1. Pon una pieza</b>
      Usa tus <b>losetas de camino</b> para crear pasillos. Al menos un lado debe tocar un camino abierto.
      <div class="img-card"><img src="camino.jpg"></div>
    </div>
    <div class="kid-box">
      <b>2. El Objetivo</b>
      Busca las piezas de <b>Salida</b> en las esquinas. ¡Si llegas ahí, ganas!
      <div class="img-card"><img src="salida.jpg"></div>
    </div>
    <button onclick="goTo('players')">¡Entendido!</button>
  </div>
</div>

<div id="game" class="screen">
  <h2 id="turn-tag">HÉROE 1</h2>
  <div class="scroll">
    <div class="dots">
      <div id="ap1" class="dot">1</div><div id="ap2" class="dot">2</div><div id="ap3" class="dot">3</div>
    </div>
    <button onclick="usarAccion()">Gastar Acción</button>
    
    <p id="log">Toca una pieza si no sabes qué hace:</p>
    
    <div class="grid-help">
      <div class="help-item" onclick="explicar('Estrella', '¡Supervelocidad! Tienes 4 acciones este turno.')">
        <img src="estrella.jpg"><br>Estrella
      </div>
      <div class="help-item" onclick="explicar('Derrumbe', '¡Rocas caen! Bloquea un camino para siempre.')">
        <img src="derrumbe.jpg"><br>Derrumbe
      </div>
      <div class="help-item" onclick="explicar('Minotauro', '¡El toro despierta! Ponlo en el centro y muévelo 2 pasos.')">
        <img src="minotauro.jpg"><br>Minotauro
      </div>
      <div class="help-item" onclick="explicar('Muros', 'No puedes pasar por las líneas negras. ¡Gira la pieza!')">
        <img src="camino.jpg"><br>Paredes
      </div>
    </div>

    <button style="background:var(--gold); color:black; margin-top:20px;" onclick="finTurno()">Terminar Turno</button>
  </div>
</div>

<script>
let currentP = 1, totalP = 0, actions = 0;

function goTo(id) {
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

function iniciarMito() {
  const t = "Escuchad. Empezáis en la entrada. Usad los caminos para llegar a la salida dorada. Pero cuidado con el Minotauro.";
  const msg = new SpeechSynthesisUtterance(t);
  msg.pitch = 0.3; msg.rate = 0.8;
  window.speechSynthesis.speak(msg);
  document.getElementById('snd-ambiente').play();
  goTo('rules');
}

function startGame(n) { totalP = n; goTo('game'); resetTurn(); }

function usarAccion() {
  if (actions < 3) {
    actions++;
    document.getElementById('ap' + actions).classList.add('used');
    document.getElementById('ap' + actions).innerText = '✔';
  }
}

function finTurno() {
  document.getElementById('snd-rugido').play();
  document.getElementById('log').innerHTML = "<b style='color:red'>¡EL MINOTAURO SE MUEVE!</b>";
  setTimeout(() => {
    currentP = (currentP % totalP) + 1;
    resetTurn();
  }, 3000);
}

function explicar(nombre, texto) {
  window.speechSynthesis.cancel();
  const msg = new SpeechSynthesisUtterance(texto);
  msg.pitch = 0.4;
  window.speechSynthesis.speak(msg);
  document.getElementById('log').innerHTML = `<b>${nombre}:</b> ${texto}`;
}

function resetTurn() {
  actions = 0;
  document.getElementById('turn-tag').innerText = "HÉROE " + currentP;
  document.querySelectorAll('.dot').forEach((d,i) => { d.classList.remove('used'); d.innerText = i+1; });
  document.getElementById('log').innerText = "Planea tus 3 acciones.";
}
</script>
</body>
</html>